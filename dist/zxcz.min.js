function ZxCz(){var t={},e=function(t){return t.split("?").join("%3F").split("&").join("%26")};t.cors_proxy="https://non-cors.herokuapp.com/",t.zxcz_base="https://www.zx-spectrum.cz",t.zxcz_index=e("/index.php?cat1=3&cat2=3&games_page="),t.zxcz_download="/data/games/files/";var n=function(t){return new Promise((e,n)=>{const r=new XMLHttpRequest;r.open("GET",t),r.onload=function(){200==r.status?e(r.responseText):n(r.responseStatus)},r.onerror=function(){n(r.responseStatus)},r.send()})};t.getIndex=async function(){var r=t.cors_proxy+t.zxcz_base+t.zxcz_index+"1",a=await n(r),o=$.parseHTML(a),i=[];for(var c of(i.push({page:"1",catalogue_url:r}),$("a",$(".paging",o).first())))i.push({page:$(c).text().trim(),catalogue_url:t.cors_proxy+t.zxcz_base+"/"+e($(c).attr("href"))});return new Promise(t=>{t(i)})},t.getLinks=async function(e){var r=await n(e),a=$.parseHTML(r),o=[];return $("tr",$("table.listbox",a)).each((function(e,n){if(e>0){var r=$("a",$("td:eq(0)",n)).text().replace(/\s\(\d+\)$/,""),a=$("a:first",$("td:eq(6)",n)).attr("href");r&&a&&(a=t.cors_proxy+t.zxcz_base+t.zxcz_download+a.slice(a.lastIndexOf("=")+1),o.push({title:r,tape_url:a}))}})),new Promise(t=>{t(o)})};var r=!1;return t.init=function(e,n,a,o){var i=$(e+" option").length;$(e).append($("<option></option>").text("ZXCZ - ZX-Spectrum.CZ full catalogue")),$(e).change((function(){switch(r=!1,$(e+" option:selected").index()-i){case 0:r=!0,$(n).empty(),t.getIndex().then((function(t){for(var e of t){var r=$("<option></option>");r.text(e.page),r.attr("href",e.catalogue_url),$(n).append(r)}$(n).trigger("change")}))}})),$(n).change((function(){r&&($(a).empty(),t.getLinks($(n+" option:selected").attr("href")).then((function(t){for(var e of t){var n=$("<option></option>");n.text(e.title),n.attr("href",e.tape_url),$(a).append(n)}$(a).trigger("change")})))})),$(a).change((function(){if(r){$(o).empty();var t=$(a+" option:selected").attr("href"),e=$("<option></option>");e.text(t.slice(t.lastIndexOf("/")+1)),e.attr("href",t),$(o).append(e),$(o).trigger("change")}})),0==i&&$(e).trigger("change")},t}
